<!DOCTYPE html>
<html>
<head>
  <title>Ansible Linux Automation Report</title>
  <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Open+Sans">
  <link rel="stylesheet" href="//code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css">
  <link rel="stylesheet" href="css/new.css">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.4/jquery.min.js"></script>
  <script src="https://code.jquery.com/jquery-1.12.4.js"></script>
  <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>
  <script>
    $(function() {
      $(".accordion").accordion({
        header: "h3",
        active: false,
        collapsible: true
      });
    });
  </script>
  <style>
    body { font-family: "Open Sans", sans-serif; background: #f4f6f9; margin: 0; padding: 0; }
    header { background: #111; padding: 15px; }
    .header-container img { height: 40px; }
    section { padding: 20px; }
    h1 { background: #1a1d23; color: #fff; padding: 15px; border-radius: 6px; }
    .download-btn { float: right; margin-top: -45px; margin-right: 20px; padding: 8px 15px; background: #fff; border: 1px solid #333; border-radius: 4px; cursor: pointer; }
    .card { background: #fff; border-radius: 8px; padding: 20px; margin-bottom: 20px; box-shadow: 0 2px 6px rgba(0,0,0,0.15); }
    .hostname { font-size: 20px; font-weight: bold; display: inline-block; margin-left: 10px; }
    .status { background: #28a745; color: #fff; font-size: 12px; padding: 4px 10px; border-radius: 12px; margin-left: 10px; }
    .details { margin-top: 10px; font-size: 14px; }
    .accordion { margin-top: 10px; }
    .accordion h3 { font-size: 14px; cursor: pointer; padding: 6px; }
    .accordion pre { background: #f8f9fa; padding: 10px; border-radius: 4px; overflow-x: auto; }
  </style>
</head>
<body>
<div class="wrapper">
  <header>
    <div class="header-container">
      <a href="https://ansible.com">
        <img src="redhat-ansible-logo.svg" alt="Red Hat Ansible" />
      </a>
    </div>
  </header>

  <section>
    <h1>Ansible Linux Automation Report</h1>
    <button class="download-btn">Download CSV</button>

    {% for linux_host in ansible_play_hosts|sort %}
    <div class="card">
      <div>
        <img src="server.png" alt="server" width="24" style="vertical-align: middle;">
        <span class="hostname">{{ hostvars[linux_host]['inventory_hostname'].split('.')[0] }}</span>
        <span class="status">Up-to-date</span>
      </div>
      <div class="details">
        <b>Package Manager:</b> {{ hostvars[linux_host]['ansible_pkg_mgr']|default("none") }} &nbsp; | &nbsp;
        <b>OS:</b> {{ hostvars[linux_host]['ansible_distribution']|default("none") }} {{ hostvars[linux_host]['ansible_distribution_version']|default("none") }} &nbsp; | &nbsp;
        <b>Kernel:</b> {{ hostvars[linux_host]['ansible_kernel']|default("none") }}
      </div>
      <div class="accordion">
        <h3>Last Patch Info</h3>
        <div>
          <pre>{{ hostvars[linux_host]['last_patch_info']|default('No patch info available') }}</pre>
        </div>
      </div>
    </div>
    {% endfor %}
  </section>
</div>
</body>
</html>
